{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "description": "A list of mappings from Puli paths to filesystem paths/other Puli paths.",
    "definitions": {
        "relativePath": {
            "description": "A relative file system path.",
            "type": "string",
            "pattern": "^[^/]+(/[^/]+)*$"
        },
        "absolutePath": {
            "description": "An absolute file system path.",
            "type": "string",
            "pattern": "^([a-zA-Z]:)?/(([^/]+/)*[^/]+)?$"
        },
        "filePath": {
            "description": "A path of a file in the file system.",
            "type": "string",
            "oneOf": [
                { "$ref": "#/definitions/relativePath" },
                { "$ref": "#/definitions/absolutePath" }
            ]
        },
        "directoryPath": {
            "description": "A path of a directory in the file system.",
            "type": "string",
            "oneOf": [
                { "$ref": "#/definitions/relativePath" },
                { "$ref": "#/definitions/absolutePath" }
            ]
        },
        "fileLink": {
            "description": "A link to a file in the Puli repository. The target must be a file reference.",
            "type": "string",
            "pattern": "^@(/[^/]+)+$"
        },
        "directoryLink": {
            "description": "A link to a directory in the Puli repository. The target must be a directory reference or a merged directory.",
            "type": "string",
            "pattern": "^@(/[^/]+)+$"
        },
        "fileReference": {
            "description": "A reference to a single file or file link.",
            "type": "string",
            "oneOf": [
                { "$ref": "#/definitions/filePath" },
                { "$ref": "#/definitions/fileLink" }
            ]
        },
        "directoryReference": {
            "description": "A reference to a single directory or directory link.",
            "type": "string",
            "oneOf": [
                { "$ref": "#/definitions/directoryPath" },
                { "$ref": "#/definitions/directoryLink" }
            ]
        },
        "mergedDirectory": {
            "description": "A reference to multiple directories or directory links. The contents of these directories are merged. Files in later entries are preferred over those in earlier entries.",
            "type": "array",
            "minItems": 1,
            "items": { "$ref": "#/definitions/directoryReference" },
            "uniqueItems": true
        }
    },
    "patternProperties": {
        "^/(([^/]+/)*[^/]+)?+$": {
            "oneOf": [
                { "$ref": "#/definitions/fileReference" },
                { "$ref": "#/definitions/directoryReference" },
                { "$ref": "#/definitions/mergedDirectory" }
            ]
        }
    },
    "additionalProperties": false
}
